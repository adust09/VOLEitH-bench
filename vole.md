VOLE in the Head（VOLEitH）に関する解説を、指定された流れと学術的な要件に従い、以下に記述します。

---

## 予備知識：Vector Oblivious Linear Evaluation (VOLE) および VOLE-in-the-Head

本稿では、ゼロ知識証明システムを構築するために用いられる、Vector Oblivious Linear Evaluation（VOLE）、VOLEベースゼロ知識（VOLE-ZK）、および VOLE-in-the-Head（VOLEitH）の概念について解説する。

### 1. Vector Oblivious Linear Evaluation (VOLE)

VOLE は、情報理論的安全性を基盤としたゼロ知識証明の構成要素として重要な役割を果たす。特に、VOLEは線形準同型コミットメントスキームの一種として利用される。

$k$ をセキュリティパラメータとし、$\mathbb{F}_{2^k}$ を有限体とする。VOLE（Vector Oblivious Linear Evaluation）相関は、長さ $\ell$ のベクトルに対して定義される。VOLE相関は、以下のパラメータによって特徴づけられる:

1.  **グローバルキー** ($\Delta \in \mathbb{F}_{2^k}$): ランダムに選択される。
2.  **ランダムビット**（$u_i \in \mathbb{F}_2$）の集合。
3.  **VOLEタグ**（$v_i \in \mathbb{F}_{2^k}$）の集合。
4.  **VOLEキー**（$q_i \in \mathbb{F}_{2^k}$）の集合。

これらの要素は、以下の**VOLE相関式**を満たす:

$$
q_i = u_i \cdot \Delta + v_i \quad \text{for } i = 0, \ldots, \ell-1 \quad (1)
$$

ここで、**証明者（Prover, P）**は $u_i$ および $v_i$ の値を知り、**検証者（Verifier, V）**は $q_i$ および $\Delta$ の値を持つ。

このVOLE相関は、証明者がランダムビット $u_i$ にコミットするための**線形準同型コミットメントスキーム**として機能する。

*   **秘匿性（Hiding）**: 検証者の持つ $q_i$ の値において、ランダムな $v_i$ が $u_i$ をマスクするため、秘匿性が保証される。
*   **拘束性（Binding）**: 証明者が $\Delta$ の知識なしに、コミットした値 $u_i$ と異なる値 $u'_i$ に開示するためには、$\Delta$ を推測する必要がある。これは $\mathbb{F}_{2^k}$ において確率 $2^{-k}$ でしか起こり得ないため、拘束性が保証される。

### 2. VOLEベースゼロ知識証明 (VOLE-ZK) の課題

VOLE相関の線形準同型性（加法準同型性）は、効率的なゼロ知識証明（VOLE-ZK）を構築する上で特に有用である。VOLE-ZKプロトコルは、事前に準備されたランダムなVOLE相関を用いて、コミット・アンド・プルーフ型の構造で、非常に効率的な証明を可能にする。例えば、QuickSilverプロトコル は、このパラダイムに基づいている。

しかし、従来のVOLE-ZKプロトコルは本質的に**指定検証者証明**（designated verifier proofs）であった。これは、プロトコルの健全性（Soundness）を確保するために、**検証者（V）が秘密の状態**、すなわち $\Delta$ と $q_i$ の値を保持し続ける必要があったためである。この制約により、証明が第三者による検証を可能とする**公開検証可能性**（public verifiability）を持たなかった。

### 3. VOLE-in-the-Head (VOLEitH) による公開検証可能性の獲得

VOLE-in-the-Head（VOLEitH）は、VOLE-ZKプロトコルを非対話形式に変換し、公開検証可能性を達成するための新しい手法である。

VOLEitHは、指定検証者設定のゼロ知識プロトコルを、非対話型かつ公開検証可能（NIZK）なプロトコルへと変換する**コンパイラ**として機能する。この変換は、OT（Oblivious Transfer）ベースのZKプロトコルをコンパイルする一般的なアプローチに基づいており、VOLE相関を生成するプロセスを、**計算的に秘匿性があり、直線的に抽出可能なオール・バット・ワンベクトルコミットメント**に基づいたメカニズムで置き換えることにより実現される。

#### VOLEitHのメカニズム：秘密のコミットメントと遅延されたチャレンジ

VOLEitHが公開検証可能性を獲得する鍵は、検証者と秘密の状態を共有することなく、証明者が自己完結的にVOLE相関をコミットメントできる点にある。

1.  **シード生成とコミットメント**: 証明者（P）はまず、自身の値 $u_i$ と $v_i$ を生成する。これらの値は、擬似乱数シードのベクトルコミットメント（**オール・バット・ワンベクトルコミットメント**）を用いてコミットされる。
    *   このコミットメントは、長さ倍増PRGの木構造（GGM構成）を利用して構築される。
    *   証明者（P）は、単一のハッシュ値（コミットメント）を送信する。これにより、Pは $N$ 個のシード（擬似乱数）にコミットする。
2.  **VOLE相関への変換**: Pは、このベクトルコミットメントをVOLE相関に変換する。
3.  **チャレンジの遅延と非対話化**: 重要な点として、VOLE相関の**グローバルキー $\Delta$ は、ゼロ知識証明の主要なステップが実行された後でなければ、Pに与えられてはならない**。
    *   $\Delta$ が事前に知られると、VOLEコミットメントの**拘束性**が破られてしまうためである。
    *   VOLEitHでは、検証者（V）からのチャレンジ $\Delta$ は、Fiat-Shamir変換を用いて、証明のトランスクリプトのハッシュ値から導出される。
4.  **開示と検証**: チャレンジ $\Delta$ が確定した後、Pはベクトルコミットメントの開示（opening）を送信する。この開示は、コミットされた $N$ 個のシードのうち $N-1$ 個を、わずか $O(\log N)$ の通信量で開示する。
    *   Vは、この開示と $\Delta$ を用いて、VOLE相関式 (1) を満たす $q_i$ の値を再構築し、Pの計算が正しいことを検証できる。

このようにして、VOLEitHは、検証者が秘密の状態を事前に保持することなく、プロトコル全体を非対話型に変換することを可能とし、**誰でも検証可能な公開検証可能性**を実現する。

### 4. VOLE in the Headの応用

VOLEitHは、その効率性と公開検証可能性から、様々な暗号学的構成要素に応用されている。

VOLEitHの重要な応用の一つとして、**FAEST**が挙げられる。FAESTは、VOLEitH構成に基づくポスト量子署名スキームであり、VOLEitHとQuickSilver情報理論的証明システムを組み合わせることにより、非対話型署名アルゴリズムを構築している。FAESTは、AES（Advanced Encryption Standard）のプリイメージの知識を証明することに基づいて設計されており、対称鍵プリミティブのみに依存する保守的なセキュリティ仮定を用いている。FAESTは、その効率的な設計により、他のポスト量子署名スキームと比較して、署名サイズが最小クラスとなることを実現している。FAESTのゼロ知識証明システムは、VOLEitHにより、公開検証可能となっている。
