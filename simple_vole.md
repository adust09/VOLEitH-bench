お客様のクエリに基づき、**SoftSpokenOT**を前提とした基本的なVector Oblivious Linear Evaluation (VOLE) の仕組みについて、提供された情報源を参照しながら詳細に解説します。

VOLEは、Vector Oblivious Linear Evaluationの略であり、証明者（Prover, P）と検証者（Verifier, V）の間で、秘密裡に線形代数的な相関関係を確立する二者間プロトコルです。VOLEは、Oblivious Transfer (OT) の算術形式と見なされます。

VOLE相関は、有限体$F_{2^k}$上で、以下の線形方程式によって定義されます。

$$q_i = u_i \cdot \Delta + v_i \quad (\text{for } i = 0, \ldots, \ell - 1) $$

ここで、Pは秘密の値 $u_i$ とランダムなVOLEタグ $v_i$ を知り、Vはグローバルキー $\Delta$ とVOLEキー $q_i$ を知ります。

VOLEは、Pがランダムビット $u_i$ に対してコミットするための**線形準同型コミットメントスキーム**として機能します。このコミットメントは、ランダムな $v_i$ によって $u_i$ がマスクされるため「秘匿性（hiding）」を持ち、Pが$\Delta$を知らない限り不正な値に開示できないため「拘束性（binding）」を持ちます。

### 1. プロトコル全体を各ステップごとに説明する

SoftSpokenOT は、VOLE相関を効率的に実現するための基盤となるプロトコルであり、特にFAESTやzkPassで用いられるVOLE-in-the-Head (VOLEitH) の中核技術として統合されています。

この構築は、OTの特性である**オール・バット・ワン（$N-1$ out of $N$）**の秘密開示メカニズムを、擬似乱数生成器（PRG）とベクトルコミットメント（VC）の構造に組み込むことで実現されます。

以下に、VOLE相関を生成する主要なステップを示します（$N=2^k$とします）。

#### ステップ 1: Pによるシードの生成とコミットメント
1. **シードの生成:** P（証明者/署名者）は、$N$個の擬似乱数シード$sd_0, \ldots, sd_{N-1}$を生成します。
2. **コミットメント:** Pは、これらのシードに対して**All-but-One Vector Commitment (VC)** スキームを用いてコミットします。VCは、長さ倍増PRGのツリー構造（GGM構成）を使用して構築されます。
3. **ハッシュの送信:** Pは、生成されたコミットメントから単一のハッシュ値$h_{com}$を計算し、V（検証者）に送信します。

#### ステップ 2: PによるVOLE値（uとv）の計算
1. **PRGによる展開:** Pは、コミットした各シード$sd_i$をPRGで展開し、長さ$\hat{\ell}$の文字列$r_i \in \{0, 1\}^{\hat{\ell}}$を得ます。
2. **VOLE値の計算:** Pは、これらの$N$個の文字列$r_i$を用いて、自身のVOLE値である$u$（ベクトル）と$v$（ベクトルまたは行列$V$）を有限体$F_{2^k}$上で計算します。
    $$u = \sum_{i=0}^{N-1} r_i$$
    $$v = \sum_{i=0}^{N-1} i \cdot r_i$$
    この$u$と$v$は、Pの秘密の入力となります。

#### ステップ 3: Vによるチャレンジ ($\Delta$) の決定と開示要求
1. **チャレンジの決定:** Vは、ランダムなグローバルキー$\Delta \in F_{2^k}$を決定します。OTの文脈では、この$\Delta$はPが$N$個のシードのうちで「開示しない」インデックス$j^*$に対応します。
2. **開示要求:** VはPに対し、$\Delta$に対応するインデックス$j^*$を除く、すべての$N-1$個のシードの開示（Open）を要求します（FAESTの非対話的設定では、$\Delta$はFiat-Shamir変換によって決定されます）。
    *注: $\Delta$は、VOLEの拘束性を維持するため、ゼロ知識証明の主要なステップが実行された後にのみPに知らされることが重要です。*

#### ステップ 4: VによるVOLEキー ($q$) の再構成
1. **Pによる開示:** Pは、VC.Openアルゴリズムを用いて、$\Delta$に対応するシード$sd_{\Delta}$以外のすべてのシードを開示情報$pdecom$としてVに送ります。
2. **Vによる再構成:** Vは、Pから受け取った$N-1$個のシードを再構成し、$\Delta$とこれらの情報を用いて、以下の計算を実行します。
    $$q = \sum_{x \in F_{2^k}, x \neq \Delta} t_x (\Delta - x) = u\Delta + v$$
    この結果、Vは$q$と$\Delta$を知り、Pは$u$と$v$を知るというVOLE相関 $q = u\Delta + v$ が確立されます。

### 2. 加法と乗法の計算方法の解説

VOLE相関の最も強力な特性は、線形準同型性です。これにより、PとVは、認証された秘密の値$u$に対して、通信をせずに計算を実行できます。

#### 加法とスカラー乗法（線形演算）

VOLE MACは**加法準同型性**を持ちます。同じグローバルキー$\Delta$を持つ$n$個のVOLE MACs $(u_i, v_i, q_i)$と公開定数$c, c_1, \ldots, c_n \in F_{2^k}$が与えられたとき、PとVは、新しいMAC $(u', v', q')$をローカルに計算できます。

1. **新しい秘密の値 $u'$ の計算:**
   $$u' = c + \sum_{i=1}^{n} c_i \cdot u_i$$

2. **P（証明者）による計算（VOLEタグ $v'$ の計算）:**
   Pは、新しいVOLEタグ$v'$を計算します。この計算には、公開定数$c$は**含まれません**。
   $$v' = \sum_{i=1}^{n} c_i \cdot v_i$$

3. **V（検証者）による計算（VOLEキー $q'$ の計算）:**
   Vは、新しいVOLEキー$q'$を計算します。
   $$q' = c \cdot \Delta + \sum_{i=1}^{n} c_i \cdot q_i$$

$q'$と$u', v'$の関係は、$q' = u' \cdot \Delta + v'$というVOLE相関を引き続き満たします。

また、定数$c$自体を認証する場合（認証された定数）は、Pが$v := 0$とし、Vが$q := c \cdot \Delta$とすることで、VOLE MACを生成できます。

#### 乗法（非線形演算）

乗法（例: $w_\gamma = w_\alpha \cdot w_\beta$）のような非線形演算は、線形準同型性だけでは処理できないため、**QuickSilver**プロトコルなどのVOLEベースのゼロ知識証明システム内で、特別な乗法ゲートチェックを通じて検証されます。

乗法チェックは、PとVが保持するVOLE MACsが、対応する値$w_\alpha, w_\beta, w_\gamma$の乗算関係を正しく満たしているかを、$\Delta$の秘密性を利用して確認するものです。

1. **Pによる証明値の計算と送信:**
   Pは、乗法ゲートに関わるVOLEタグ$v$と秘密の値$w$に基づいて、中間値$a_{0}$と$a_{1}$を計算し、Vに送信します。

2. **Vによる検証:**
   Vは、自身のVOLEキー$q$とグローバルキー$\Delta$、そしてPから受け取った$a_0, a_1$を用いて、以下の等式が成立するかを確認します。
   $$b \stackrel{?}{=} a_{0} + a_{1} \cdot \Delta$$
   ここで$b$は、Vが持つ$q$値から計算される値です。

このチェックが成功すれば、Pが正直に計算を行ったことが高確率で保証されます。もしPが不正な$w$でコミットしようとした場合、この線形等式を満たすためにはVの秘密キー$\Delta$を推測する必要があり、成功確率は$2^{-k}$でしかありません。

VOLEは、線形操作を無料で（通信なしで）行えるため、複雑な回路計算を非常に効率的にゼロ知識証明する基盤となります。これは、**「秘密の定規と分度器（VOLE MAC）を使って、誰も見ていない場所で、安全に線形計算を何度でも行うことができる」**ようなものです。ただし、非線形な「掛け算」が必要な場合は、特別な証明手続きを介して、計算結果が不正ではないことを確認する必要があります。
